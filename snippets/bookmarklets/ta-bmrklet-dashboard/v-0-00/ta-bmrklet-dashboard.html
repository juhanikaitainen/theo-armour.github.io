<!doctype html>
<html lang = "en" >
<head>
<meta charset = "utf-8" >
<meta name = "viewport" content= "width=device-width, initial-scale=1" >
<meta name = "description" content = "Bookmarklet dashboard" >
<meta name = "keywords" content = "JavaScript,GitHub,FOSS" >
<meta name = "date" content = "2019-09-14" >
<meta name = "version" content = "0.00.00" >
<title></title>
<style>

	* { box-sizing: border-box; }

	:root { --mnu-width: 22rem; --screen-width: calc( 100vw ); --headerHeight: 6rem; }

	html { height: 100%; }

	body { font: 12pt monospace; margin: 0 auto; max-width: 800px; padding: 0 0.5rem; }

	a { color: crimson; text-decoration: none; }
	a:hover, a:focus, a:active { background-color: yellow; color: #aaa; text-decoration: underline }

	button, input[type=button] { background-color: #ddd; border: none; color: #322; cursor: pointer; padding: 3px 5px; }
	button:hover { background: #ccc; color: #fff }

	/*
	main { border: 0px; height: 100%; left: var( --mnu-width ); margin: 0;
		padding: 0 1rem; position: absolute; width: calc( 100% - var( --mnu-width ) );  }

	#navMenu { background-color: #eee; left: 0; margin: 0; padding: 0 1rem;
		position: absolute; top: 0; width: var( --mnu-width ); }
	*/

</style>
</head>
<body>

	<nav id="navMenu" >

		<div id="divTitle" ></div>
<!--
	<p>
		<button id=but onclick=setIt(); accessKey= 'z' title='access key: z '>buttonbutton</button>
	</p>
-->

	</nav>

	<main>

		<div id="divContents" ></div>

		<p>
			<a href = "JavaScript:( function(){
				const script=document.head.appendChild( document.createElement( 'script' ) );
				script.src='https://theo-armour.github.io/snippets/bookmarklets//ta-bmrklet/v-0-00/ta-bmrklet.js'; } )()" >
				ta-bmarklet.js</a> theo armour bookmarklet github
		</p>

		<p>
			<a href = "JavaScript:( () => {
				const script=document.head.appendChild( document.createElement( 'script' ) );
				script.src='../../ta-bmrklet/v-0-00/ta-bmrklet.js';
			} )()" >
				ta-bmarklet.js
			</a> theo armour bookmarklet local
		</p>

		<p>
				<a href = "JavaScript:( () => {
					const script=document.head.appendChild( document.createElement( 'script' ) );
					script.src='https://theo-armour.github.io/snippets/bookmarklets/bookmarklets/capture-bookmark.js';
				} )()" >
					CBMg
				</a> stand alone github
			</p>

			<p>
				<a href = "JavaScript:( () => {
					const script=document.head.appendChild( document.createElement( 'script' ) );
					script.src='../../bookmarklets/capture-bookmark.js';
				} )()" >
					CBM
				</a> stand alone local
			</p>

			<a href="vscode://file/d:/Dropbox/Public/git-repos/theo-armour.github.io/snippets/snippets/vs-code.md" target="_blank">vscode.md</a>

<!--
		<p>
			<a href = "JavaScript:( () => {

				let fileName;
				let domain;

				console.log( '', document.title );

				const divTooToo=document.body.appendChild( document.createElement( 'div' ) );

				divTooToo.style.cssText =
				'background-color: white; border: 1px solid red; max-height: 90%; width: 350px; opacity: 0.95; ' +
				' overflow: auto; padding: 10px; position: absolute; right: 30px; resize: both;
				top: 20px; z-index:100000; ';

				divTooToo.innerHTML =
				`
				${ document.title }
				`;

				console.log( '', divTooToo );

			 } )()" >
				CBM
			</a> capture bookmark - run anywhere
		</p>
-->

		<p>
			<a href = "JavaScript:( () => {

				const divTooToo=document.body.appendChild( document.createElement( 'div' ) );

				divTooToo.style.cssText =
					'background-color: white; border: 1px solid red; max-height: 90%; width: 350px; opacity: 0.95; ' +
					' overflow: auto; padding: 10px; position: absolute; right: 30px; resize: both;
					top: 20px; z-index:100000; ';


				init();

				function init() {

					const date = new Date().toISOString();

					const htm =
					`
					<div class=titleCBM >title: </div><input id=inpTitle class=inputCBM oninput=updateJson() value='${ document.title }' >

					<div class=titleCBM >url: </div><input id=inpUrl class=inputCBM value='${ location.href }' >

					<div class=titleCBM >filename: </div><input id=inpFileName class=inputCBM value='${  getFileName() }' >

					<div class=titleCBM >favicon: </div><input id=inpFavicon class=inputCBM >

					<div class=titleCBM >images: </div><input id=inpImages class=inputCBM>

					<div class=titleCBM >uuid: </div><input id=inpUuid class=inputCBM  value='${ getUuidv4() }' >

					<div class=titleCBM >date:</div><input id=inpDateAdd style=width:12rem; value='${ date }' >

					<br>

					<div class=titleCBM >tags: </div><textarea id=txtTags style=width:100%; ></textarea>

					<div class=titleCBM >description: </div><textarea id=txtDescription style=width:100%; ></textarea>

					<div class=titleCBM >json: </div><textarea id=txtJson style=height:15rem;width:100%; ></textarea>

					<button onclick=saver(); >save</button>
					`;

					divTooToo.innerHTML = htm;

					inpFavicon.value = `https://www.google.com/s2/favicons?domain=${ document.domain }`;

					updateJson();

				}


				function updateJson() {

					const tags = `['${ txtTags.value.slice().replace( /,/g, '','') }']`;

					console.log( 'document.lastModified', document.lastModified );

					const txt =
				`{\n
				'url': '${inpUrl.value }',\n
				'title': '${ inpTitle.value }',\n
				'name': '${ inpFileName.value }',\n
				'dateAdd': '${ inpDateAdd.value }',\n
				'dateUpdate': '${ inpDateAdd.value }',\n
				'id': '${ inpUuid.value }',\n
				'type': 'url',\n
				'images': [ ${ inpImages.value } ],\n
				'favicon': '${ inpFavicon.value }',\n
				'tags': ${ tags },\n
				'description': '${ txtDescription.value }'\n
				}`;

					txtJson.value = txt;

					saver()

				}


				function getFileName() {

					console.log( '', location );

					console.log( '', location.domain );

					domain = document.domain ? document.domain.replace( /\./g, '-') : 'file';
					const title = document.title ? document.title.replace( / /g, '-') : '';
					fileName = domain + '-' + title + '.json';

					return fileName;

				}


				function getUuidv4() {

					return ( [ 1e7 ] + -1e3 + -4e3 + -8e3 + -1e11 ).replace( /[018]/g, c =>
						( c ^ crypto.getRandomValues( new Uint8Array( 1 )  )[ 0 ] & 15 >> c / 4 ).toString( 16 )
					);

				}


				function saver() {

					const strings = txtJson.value;
					/*console.log( 'str', strings ); */

					const blob = new Blob( [ strings ] );
					let a = document.body.appendChild( document.createElement( 'a' ) );
					a.href = window.URL.createObjectURL( blob );
					a.download = fileName;
					a.click();
					a = null;

				}


			} )()" >
				CBM2
			</a> capture bookmark - run anywhere
		</p>
<script>

const urlSourceCode = 'https://github.com/theo-armour/theo-armour.github.io/tree/master/snippets/bookmarklets';
const urlSourceCodeIcon = 'https://pushme-pullyou.github.io/github-mark-32.png';

init();

function init() {

	divTitle.innerHTML = getTitle();

	//divContents.innerHTML += `${ ( new Date ) }<p>lorem ipsum, quia dolor sit, amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt, ut labore et dolore magnam aliquam quaerat voluptatem. ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? quis autem vel eum iure reprehenderit, qui in ea voluptate velit esse, quam nihil molestiae consequatur, vel illum, qui dolorem eum fugiat, quo voluptas nulla pariatur?</p>`;

}



function setIt() {

	//divContents.innerHTML += `<p>${ ( performance.now() ) } - Howdy! </p>`;

}



function getTitle() {

	document.title = document.title ? document.title : location.href.split( '/' ).pop().slice( 0, - 5 ).replace( /-/g, ' ' );
	const version = document.head.querySelector( "[ name=version ]" ).content;

	const htm =
	`
		<h2>
			<a href=${ urlSourceCode } target=_top title="Source code on GitHub" >
				<img src=${ urlSourceCodeIcon } height=18 style=opacity:0.5; >
			</a>
			<a href="" title="Click to reload this page" >${ document.title } ${ version }</a>
		</h2>

		<p>
			${ document.head.querySelector( "[ name=description ]" ).content }
		</p>
	`;

	return htm;

}

</script>
</body>
</html>